<html>
  <head>
    <title>Tokimeki Unfollow</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="mobile.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div id="app" v-cloak>
      <finish v-if="finished"
        v-bind:startcount="start_count"
        v-bind:keptcount="kept.length"
        v-bind:listcount="addedToList.length"
        ></finish>
      <intro
        v-else-if="introFinished == false"
        v-on:intro-finished="introFinished = true; updatePrefs($event)"
        v-bind:username="user.screen_name"
        v-bind:loadedprogress="loadedProgress"
        v-bind:followingcount="friends.length"
        v-bind:initialorder="prefs.order"
        v-bind:initialsaveprogressaslist="prefs.saveProgressAsList"
        v-bind:initialshowbio="prefs.showBio">
      </intro>
      <div v-else class="flex-parent">
        <div id="twttr-widget" class="flex-top"
          v-bind:class="{
            loading:loadingSelFriend,
            faded:loadedProgress,
            unfollowed:selFriendIsUnfollowed,
            kept:selFriendIsKept
          }">
          <twttr-widget
            v-bind:username="friend.screen_name"
            v-bind:id="selFriendId"
            v-bind:private="friend.protected"></twttr-widget>
        </div>
        <div class="flex-bottom">
          <div id="ctrl">
            <div id="avvy"></div>
            <div id="info">
              <div v-if="loadedProgress">
                <p>
                  Welcome back! I've loaded your progress from last time, when you 
                  kept {{ kept.length }} accounts that were important to you.
                </p>
                <strong>Let's get started on the {{ friends.length }} accounts left!</strong>

                <div id="btns">
                  <a href="#" v-on:click="loadedProgress = false" class="button dib">Start</a>
                </div>
              </div>
              <div v-else-if="selFriendIsUnfollowed">
                <p>
                  Great, unfollowed! Let's thank
                  <strong>{{ friend.name }}</strong>
                  for all the tweets you've enjoyed before.
                </p>
                <div id="btns">
                  <a href="#" v-on:click="follow" class="button dib">Undo</a>
                  <a href="#" v-on:click="next" class="button dib">Next</a>
                </div>
              </div>
              <div v-else-if="selFriendIsKept">
                <p>
                  Glad to hear
                  <strong>{{ friend.name }}</strong>'s
                  tweets are still important to you. 
                </p>
                <div id="btns">
                  <a href="#" v-on:click="unkeep" class="button dib">Undo</a>
                  <a href="#" v-on:click="next" class="button dib">Next</a>
                </div>
              </div>
              <div v-else>
                <span v-if="loadingSelFriend">Loading next follow...</span>
                <span v-else>
                  <span v-if="selFriendIsAddedToList">
                    <p>
                      Added
                      <strong>{{ friend.name }}</strong>
                      to <strong>{{ lastAddedToList }}!</strong>
                    </p>
                    <p>
                      Did you know? You can still view someone's tweets in a list even if you don't follow them.
                    </p>
                  </span>
                  <span v-else>
                    <p>
                      <span v-if="sel == 0">First up,</span>
                      <span v-else-if="sel < (friends.length - 1)">#{{sel + 1}}:</span>
                      <span v-else>Last but not least,</span>
                      <strong>{{ friend.name }}</strong>, a.k.a.
                      <span class="gray">@{{ friend.screen_name }}</span>!
                      <span v-if="showBio==false">
                        <a href="#" v-on:click="showBio = true" class="keepblue">Show bio</a>
                      </span>
                      <span v-else id="bio">
                        <span class="">&ldquo;{{ friend.description }}&rdquo;</span>
                        <a href="#" v-on:click="showBio = false" class="keepblue">Hide bio</a>
                      </span>
                    </p>
                    <p>
                      Do the tweets still spark joy or feel important to you?
                    </p>
                  </span>
                  <div id="btns">
<!--                 <a href="#" v-on:click="prev" class="button dib"><-</a> -->
                    <div v-if="!showAddToListMenu">
                      <button v-on:click="unfollow" class="button dib">Unfollow</button>
                      <button v-on:click="showAddToListMenu = true" class="button dib">
                        <span class="small-screen">+ List</span>
                        <span class="big-screen">Add to List</span>
                      </button>
                      <button v-on:click="keep" class="button dib">Keep</button>
                    </div>
                    <add-to-list-menu
                      v-if="showAddToListMenu"
                      v-on:add-to-list="addToList($event)"
                      v-on:create-list="createList($event)"
                      v-on:close-menu="showAddToListMenu = false"
                      v-bind:lists="lists"></add-to-list-menu>
<!--                 <a href="#" v-on:click="next" class="button dib">-></a> -->
                  </div>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="logout">
        <a v-if="!introFinished || finished" href="/logout" class="gray">Log Out</a>
        <a v-else href="#" v-on:click="introFinished=false" class="gray">Options</a>
      </div>
      <div id="alert" v-if="savedProgress">
          Saved progress!
      </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <script type="module" src="/modules/_autolinker.js" defer=""></script>
  <script src="https://cdn.jsdelivr.net/npm/vue2-timeago@1.1.3/dist/vue2-timeago.min.js"></script>
  <script type="module" src="/client.js" defer=""></script>
  </body>
</html>